---
title: "Data Processing"
output: html_notebook
---


```{r, setup}

library(tidyverse)
library(magrittr)

```


#Import CSV, create ID var
```{r}

RAW <- read_csv("/Users/sjp2154/Dropbox/Gender economics/Exploitation IPW-MSM/J253356/variablesnolabel.csv")

df <- RAW

df$ID <- df$ER30001*1000 + df$ER30002

```

#RENAME VARIABLES
##Age Head
```{r}
Age.Head <- df %>% select(one_of(c("V117", "V1008", "V1239", "V1942", "V2542", "V3095", "V3508", "V3921", "V4436", "V5350", "V5850", "V6462", "V7067", "V7658", "V8352", "V8961", "V10419", "V11606", "V13011", "V14114", "V15130", "V16631", "V18049", "V19349", "V20651", "V22406", "ER2007", "ER5006", "ER7006", "ER10009", "ER13010", "ER17013", "ER21017", "ER25017", "ER36017", "ER42017", "ER47317", "ER53017", "ER60017")))

names(Age.Head) <- mapply(paste, "Age.Head", c(seq(1968,1997,1), seq(1999,2015, 2)), sep="_")
```

##Age Spouse
```{r}
Age.Spouse <- df %>% select(one_of(c("V118", "V1011", "V1241", "V1944", "V2544", "V3097", "V3510", "V3923", "V4438", "V5352", "V5852", "V6464", "V7069", "V7660", "V8354", "V8963", "V10421", "V11608", "V13013", "V14116", "V15132", "V16633", "V18051", "V19351", "V20653", "V22408", "ER2009", "ER5008", "ER7008", "ER10011", "ER13012", "ER17015", "ER21019", "ER25019", "ER36019", "ER42019", "ER47319", "ER53019", "ER60019")))

names(Age.Spouse) <- mapply(paste, "Age.Spouse", c(seq(1968,1997,1), seq(1999,2015, 2)), sep="_" )
```

##Race Head
```{r}
Race.Head <- df %>% select(one_of(c("V181", "V801", "V1490", "V2202", "V2828", "V3300", "V3720", "V4204", "V5096", "V5662", "V6209", "V6802", "V7447", "V8099", "V8723", "V9408", "V11055", "V11938", "V13565", "V14612", "V16086", "V17483", "V18814", "V20114", "V21420", "V23276", "ER3944", "ER6814", "ER9060", "ER11848", "ER15928", "ER19989", "ER23426", "ER27393", "ER40565", "ER46543", "ER51904", "ER57659", "ER64810")))

names(Race.Head) <- mapply(paste, "Race.Head", c(seq(1968,1997,1), seq(1999,2015, 2)), sep="_" )
```


##Race Spouse
```{r}
Race.Spouse <- df %>% select(one_of(c("V12293", "V13500", "V14547", "V16021", "V17418", "V18749", "V20049", "V21355", "V23212", "ER3883", "ER6753", "ER8999", "ER11760", "ER15836", "ER19897", "ER23334", "ER27297", "ER40472", "ER46449", "ER51810", "ER57549", "ER64671")))

names(Race.Spouse) <- mapply(paste, "Race.Spouse", c(seq(1985,1997,1), seq(1999,2015, 2)), sep="_" )
```


##Family composition change variable
```{r}
FamilyComp <- df %>% select(one_of(c("V542", "V1109", "V1809", "V2410", "V3010", "V3410", "V3810", "V4310", "V5210", "V5710", "V6310", "V6910", "V7510", "V8210", "V8810", "V10010", "V11112", "V12510", "V13710", "V14810", "V16310", "V17710", "V19010", "V20310", "V21608", "ER2005A", "ER5004A", "ER7004A", "ER10004A", "ER13008A", "ER17007", "ER21007", "ER25007", "ER36007", "ER42007", "ER47307", "ER53007", "ER60007")))

names(FamilyComp) <- mapply(paste, "FamilyComp", c(seq(1969,1997,1), seq(1999,2015, 2)), sep="_" )
```

##Family Size
```{r}
FamilySize <- df %>% select(one_of(c("V115", "V549", "V1238", "V1941", "V2541", "V3094", "V3507", "V3920", "V4435", "V5349", "V5849", "V6461", "V7066", "V7657", "V8351", "V8960", "V10418", "V11605", "V13010", "V14113", "V15129", "V16630", "V18048", "V19348", "V20650", "V22405", "ER2006", "ER5005", "ER7005", "ER10008", "ER13009", "ER17012", "ER21016", "ER25016", "ER36016", "ER42016", "ER47316", "ER53016", "ER60016"))) 

names(FamilySize) <- mapply(paste, "FamilySize", c(seq(1968,1997,1), seq(1999,2015, 2)) , sep="_" )
```

##Alcohol Use Frequency Head
```{r}
AlcFreq.Head <- df %>% select(one_of(c("ER27106", "ER38317", "ER44290", "ER49628", "ER55376", "ER62498")))

names(AlcFreq.Head) <- mapply(paste, "AlcFreq.Head", seq(2005, 2015, 2), sep="_" )
```

##Alcohol Use Frequency Spouse
```{r}
AlcFreq.Spouse <- df %>% select(one_of(c("ER27229", "ER39414", "ER45387", "ER50746", "ER56492", "ER63614")))

names(AlcFreq.Spouse) <- mapply(paste, "AlcFreq.Spouse", seq(2005, 2015, 2), sep="_" )
```


##Alcohol drinks per day head
```{r}
DrinksPerDay.Head <- df %>% select(one_of(c("ER15551", "ER19716", "ER23131", "ER27107", "ER38318", "ER44291", "ER49629", "ER55377", "ER62499")))

names(DrinksPerDay.Head) <- mapply(paste, "DrinksPerDay.Head", seq(1999,2015, 2), sep="_" )
```

##Alcohol drinks per day spouse
```{r}
DrinksPerDay.Spouse <- df %>% select(one_of(c("ER15659", "ER19824", "ER23258", "ER27230", "ER39415", "ER45388", "ER50747", "ER56493", "ER63615")))

names(DrinksPerDay.Spouse) <- mapply(paste, "DrinksPerDay.Spouse", seq(1999,2015, 2), sep="_" )
```

##Alcohol days with 5 or more drinks head
```{r}
Drink5.Head <- df %>% select(one_of(c("ER27108", "ER38319", "ER44292", "ER49630", "ER55378", "ER62500")))

names(Drink5.Head) <- mapply(paste, "Drink5.Head", seq(2005, 2015, 2), sep="_" )
```

##Alcohol days with 4 or more drinks spouse
```{r}
Drink5.Spouse <- df %>% select(one_of(c("ER27231", "ER39416", "ER45389", "ER50748", "ER56494", "ER63616")))

names(Drink5.Spouse) <- mapply(paste, "Drink5.Spouse", seq(2005, 2015, 2), sep="_" )
```

##Ever smoked head
```{r}
EverSmoked.Head <- df %>% select(one_of(c("V13444", "ER15546", "ER19711", "ER23126", "ER27101", "ER38312", "ER44285", "ER49623", "ER55371", "ER62493")))

names(EverSmoked.Head) <- mapply(paste, "EverSmoked.Head", c(1986, seq(1999,2015, 2)), sep="_" )
```

##Ever smoked spouse
```{r}
EverSmoked.Spouse <- df %>% select(one_of(c("V13479", "ER15654", "ER19819", "ER23253", "ER27224", "ER39409", "ER45382", "ER50741", "ER56487", "ER63609")))

names(EverSmoked.Spouse) <- mapply(paste, "EverSmoked.Spouse", c(1986, seq(1999,2015, 2)), sep="_" )
```

##Depression before age 17 head
```{r}
Depressed17.Head <- df %>% select(one_of(c("ER38341", "ER44314", "ER49654", "ER55402", "ER62524")))

names(Depressed17.Head) <- mapply(paste, "Depressed17.Head", seq(2007,2015, 2), sep="_" )
```

##Depression before age 17 spouse
```{r}
Depressed17.Spouse <- df %>% select(one_of(c("ER39438", "ER45411", "ER50772", "ER56518", "ER63640")))

names(Depressed17.Spouse) <- mapply(paste, "Depressed17.Spouse", seq(2007,2015, 2), sep="_" )
```

##Drug or alc problem before 17 head
```{r}
DrugProb17.Head <- df %>% select(one_of(c("ER38342", "ER44315", "ER49655", "ER55403", "ER62525")))

names(DrugProb17.Head) <- mapply(paste, "DrugProb17.Head", seq(2007,2015, 2), sep="_" )
```

##Drug or alc problem before 17 spouse
```{r}
DrugProb17.Spouse <- df %>% select(one_of(c("ER39439", "ER45412", "ER50773", "ER56519", "ER63641")))

names(DrugProb17.Spouse) <- mapply(paste, "DrugProb17.Spouse", seq(2007,2015, 2), sep="_" )
```

##Health Status Growing Up head
```{r}
KidHealth.Head <- df %>% select(one_of(c("ER38323", "ER44296", "ER49636", "ER55384", "ER62506")))

names(KidHealth.Head) <- mapply(paste, "KidHealth.Head", seq(2007,2015, 2), sep="_" )
```

##Health Status Growing Up spouse
```{r}
KidHealth.Spouse <- df %>% select(one_of(c("ER39420", "ER45393", "ER50754", "ER56500", "ER63622")))

names(KidHealth.Spouse) <- mapply(paste, "KidHealth.Spouse", seq(2007,2015, 2), sep="_" )
```

##Other emotional/psychologic problems head
```{r}
EmotProb.Head <- df %>% select(one_of(c("ER38343", "ER44316", "ER49656", "ER55404", "ER62526")))

names(EmotProb.Head) <- mapply(paste, "EmotProb.Head", seq(2007,2015, 2), sep="_" )
```

##Other emotional/psychologic problems spouse
```{r}
EmotProb.Spouse <- df %>% select(one_of(c("ER39440", "ER45413", "ER50774", "ER56520", "ER63642")))

names(EmotProb.Spouse) <- mapply(paste, "EmotProb.Spouse", seq(2007,2015, 2), sep="_" )
```

##Health insurance coverage in last 2 years anyone in family
```{r}
Insurance2 <- df %>% select(one_of(c("ER15779", "ER19840", "ER23277", "ER27237", "ER40409", "ER46382", "ER51743")))

names(Insurance2) <- mapply(paste, "Insurance2", seq(1999,2011, 2), sep="_" )
```


##Health insurance head + family
```{r}
InsuranceHeadFam <- df %>% select(one_of(c("V158", "V740", "V1406", "V2118", "V2715", "V7287")))

names(InsuranceHeadFam) <- mapply(paste, "InsuranceHeadFam", c(seq(1968,1972, 1), 1980), sep="_" )
```


##Medicaid/medicare anyone in family
```{r}
Medicaid <- df %>% select(one_of(c("V6686", "V7289", "V7989", "V9299", "V10890", "V11997", "V13448", "V14520", "V15997", "V17394", "V18725", "V20025", "V21326", "V23185", "ER3857", "ER6727", "ER8973")))

names(Medicaid) <- mapply(paste, "Medicaid", c(1979, 1980, 1981, seq(1983,1996, 1)), sep="_" )
```


##K6
```{r}
K6.Head <- df %>% select(one_of(c("ER19833A", "ER23268", "ER40402", "ER46375", "ER51736", "ER57482", "ER64604")))

names(K6.Head) <- mapply(paste, "K6.Head", c(2001, 2003, seq(2007,2015, 2)), sep="_" )
```


##Doctor told you emotional, nervous, psych problems head
```{r}
DrEmotProb.Head <- df %>% select(one_of(c("ER15494", "ER19659", "ER23059", "ER27045", "ER38256", "ER44229", "ER49562", "ER55311", "ER62433")))

names(DrEmotProb.Head) <- mapply(paste, "DrEmotProb.Head", seq(1999,2015, 2), sep="_" )
```


##Age when doctor told you emotional, nervous, psych problems head
```{r}
AgeDrEmotProb.Head <- df %>% select(one_of(c("ER27046", "ER38257", "ER44230", "ER49564", "ER55312", "ER62434")))

names(AgeDrEmotProb.Head) <- mapply(paste, "AgeDrEmotProb.Head", seq(2005,2015, 2), sep="_" )
```


##Medication if doctor told you emotional, nervous, psych problems head
```{r}
MedforPsych.Head <- df %>% select(one_of(c("ER49572", "ER55320", "ER62442")))

names(MedforPsych.Head) <- mapply(paste, "MedforPsych.Head", seq(2011,2015, 2), sep="_" )

```


##Condition if doctor told you emotional, nervous, psych problems head
```{r}
ConditionPsych.Head <- df %>% select(one_of(c("ER27047", "ER38258", "ER44231", "ER49565", "ER55313", "ER62435")))

names(ConditionPsych.Head) <- mapply(paste, "ConditionPsych.Head", seq(2005,2015, 2), sep="_" )
```


##Doctor told you emotional, nervous, psych problems Spouse
```{r}
DrEmotProb.Spouse <- df %>% select(one_of(c("ER15602", "ER19767", "ER23186", "ER27168", "ER39353", "ER45326", "ER50680", "ER56427", "ER63549")))

names(DrEmotProb.Spouse) <- mapply(paste, "DrEmotProb.Spouse", seq(1999,2015, 2), sep="_" )
```


##Age when doctor told you emotional, nervous, psych problems Spouse
```{r}
AgeDrEmotProb.Spouse <- df %>% select(one_of(c("ER27169", "ER39354", "ER45327", "ER50682", "ER56428", "ER63550")))

names(AgeDrEmotProb.Spouse) <- mapply(paste, "AgeDrEmotProb.Spouse", seq(2005,2015, 2), sep="_" )
```


##Medication if doctor told you emotional, nervous, psych problems Spouse
```{r}
MedforPsych.Spouse <- df %>% select(one_of(c("ER50690", "ER56436", "ER63558")))

names(MedforPsych.Spouse) <- mapply(paste, "MedforPsych.Spouse", seq(2011,2015, 2), sep="_" )

```


##Condition if doctor told you emotional, nervous, psych problems Spouse
```{r}
ConditionPsych.Spouse <- df %>% select(one_of(c("ER27170", "ER39355", "ER45328", "ER50683", "ER56429", "ER63551")))

names(ConditionPsych.Spouse) <- mapply(paste, "ConditionPsych.Spouse", seq(2005,2015, 2), sep="_" )
```


##Doctor told you learning disorder head
```{r}
DrLearnDisord.Head <- df %>% select(one_of(c("ER15518", "ER19683", "ER23083", "ER27034", "ER38245", "ER44218", "ER49548", "ER55298", "ER62420")))

names(DrLearnDisord.Head) <- mapply(paste, "DrLearnDisord.Head", seq(1999,2015, 2), sep="_" )
```

##Age when doctor told you had learning disorder head

```{r}
AgeDrLearnDisord.Head <- df %>% select(one_of(c("ER27035", "ER38246", "ER44219", "ER49550", "ER55300", "ER62422")))

names(AgeDrLearnDisord.Head) <- mapply(paste, "AgeDrLearnDisord.Head", seq(2005,2015, 2), sep="_" )
```


##Medication if doctor told you had learning disorder head
```{r}
MedLearnDisord.Head <- df %>% select(one_of(c("ER49552", "ER55302", "ER62424")))

names(MedLearnDisord.Head) <- mapply(paste, "MedLearnDisord.Head", seq(2011,2015, 2), sep="_" )
```

##Doctor told you learning disorder Spouse
```{r}
DrLearnDisord.Spouse <- df %>% select(one_of(c("ER15626", "ER19791", "ER23210", "ER27157", "ER39342", "ER45315", "ER50666", "ER56414", "ER63536")))

names(DrLearnDisord.Spouse) <- mapply(paste, "DrLearnDisord.Spouse", seq(1999,2015, 2), sep="_" )
```

##Age when doctor told you had learning disorder Spouse

```{r}
AgeDrLearnDisord.Spouse <- df %>% select(one_of(c("ER27158", "ER39343", "ER45316", "ER50668", "ER56416", "ER63538")))

names(AgeDrLearnDisord.Spouse) <- mapply(paste, "AgeDrLearnDisord.Spouse", seq(2005,2015, 2), sep="_" )
```


##Medication if doctor told you had learning disorder Spouse
```{r}
MedLearnDisord.Spouse <- df %>% select(one_of(c("ER50670", "ER56418", "ER63540")))

names(MedLearnDisord.Spouse) <- mapply(paste, "MedLearnDisord.Spouse", seq(2011,2015, 2), sep="_" )
```

##Doctor told you loss of mental ability/memory head
```{r}
DrMemLoss.Head <- df %>% select(one_of(c("ER15512", "ER19677", "ER23077", "ER27030", "ER38241", "ER44214", "ER49543", "ER55293", "ER62415")))

names(DrMemLoss.Head) <- mapply(paste, "DrMemLoss.Head", seq(1999,2015, 2), sep="_" )
```

##Age when doctor told you loss of mental ability/memory head
```{r}
DrMemLoss.Head <- df %>% select(one_of(c("ER27031", "ER38242", "ER44215", "ER49545", "ER55295", "ER62417")))

names(DrMemLoss.Head) <- mapply(paste, "DrMemLoss.Head", seq(2005,2015, 2), sep="_" )
```

##Medication if doctor told you loss of mental ability/memory head
```{r}
DrMemLoss.Head <- df %>% select(one_of(c("ER49547", "ER55297", "ER62419")))

names(DrMemLoss.Head) <- mapply(paste, "DrMemLoss.Head", seq(2011,2015, 2), sep="_" )
```

##Doctor told you loss of mental ability/memory Spouse
```{r}
DrMemLoss.Spouse <- df %>% select(one_of(c("ER15620", "ER19785", "ER23204", "ER27153", "ER39338", "ER45311", "ER50661", "ER56409", "ER63531")))

names(DrMemLoss.Spouse) <- mapply(paste, "DrMemLoss.Spouse", seq(1999,2015, 2), sep="_" )
```

##Age when doctor told you loss of mental ability/memory Spouse
```{r}
DrMemLoss.Spouse <- df %>% select(one_of(c("ER27154", "ER39339", "ER45312", "ER50663", "ER56411", "ER63533")))

names(DrMemLoss.Spouse) <- mapply(paste, "DrMemLoss.Spouse", seq(2005,2015, 2), sep="_" )
```

##Medication if doctor told you loss of mental ability/memory Spouse
```{r}
DrMemLoss.Spouse <- df %>% select(one_of(c("ER50665", "ER56413", "ER63535")))

names(DrMemLoss.Spouse) <- mapply(paste, "DrMemLoss.Spouse", seq(2011,2015, 2), sep="_" )
```


##General health status head
```{r}
GenHealth.Head <- df %>% select(one_of(c("V10877", "V11991", "V13417", "V14513", "V15993", "V17390", "V18721", "V20021", "V21321", "V23180", "ER3853",  "ER6723", "ER8969", "ER11723", "ER15447", "ER19612", "ER23009", "ER26990", "ER38202", "ER44175", "ER49494", "ER55244", "ER62366")))
                                       
names(GenHealth.Head) <- mapply(paste, "GenHealth.Head", c(seq(1984,1997, 1), seq(1999,2015, 2)), sep="_")

```

##General health status spouse
```{r}
GenHealth.Spouse <- df %>% select(one_of(c("V10884", "V12344", "V13452", "V14524", "V15999", "V17396", "V18727", "V20027", "V21328", "V23187", "ER3858", "ER6728", "ER8974", "ER11727", "ER15555", "ER19720", "ER23136", "ER27113", "ER39299", "ER45272", "ER50612", "ER56360", "ER63482")))
                                       
names(GenHealth.Spouse) <- mapply(paste, "GenHealth.Spouse", c(seq(1984,1997, 1), seq(1999,2015, 2)), sep="_")
``` 

##Housing status own or rent
```{r}
OwnRent <- df %>% select(one_of(c("V103", "V593", "V1264", "V1967", "V2566", "V3108", "V3522", "V3939", "V4450", "V5364", "V5864", "V6479", "V7084", "V7675", "V8364", "V8974", "V10437", "V11618", "V13023", "V14126", "V15140", "V16641", "V18072", "V19372", "V20672", "V22427", "ER2032", "ER5031", "ER7031", "ER10035", "ER13040", "ER17043", "ER21042", "ER25028", "ER36028", "ER42029", "ER47329", "ER53029", "ER60030")))

names(OwnRent) <- mapply(paste, "OwnRent", c(seq(1968,1997, 1), seq(1999, 2015, 2)), sep="_")
``` 

##Income from interest head

```{r}
InterestIncome.Head <- df %>% select(one_of(c("V21861", "ER27936", "ER40926", "ER46834", "ER52242", "ER58043", "ER65221")))

names(InterestIncome.Head) <- mapply(paste, "InterestIncome.Head", c(1993, seq(2005,2015, 2)), sep="_")
```

##Income from interest spouse
```{r}
InterestIncome.Spouse <- df %>% select(one_of(c("V21925", "ER27949", "ER40939", "ER46847", "ER52255", "ER58056", "ER65249")))

names(InterestIncome.Spouse) <- mapply(paste, "InterestIncome.Spouse", c(1993, seq(2005,2015, 2)), sep="_")
```

##Total income from labor head
```{r}
TotalLaborIncome.Head <- df %>% select(one_of(c("V74", "V514", "V1196", "V1897", "V2498", "V3051", "V3463", "V3863", "V5031", "V5627", "V6174", "V6767", "V7413", "V8066", "V8690", "V9376", "V11023", "V12372", "V13624", "V14671", "V16145", "V17534", "V18878", "V20178",  "V21484", "V23323", "ER4140", "ER6980", "ER9231", "ER12080", "ER16463", "ER20443", "ER24116", "ER27931", "ER40921", "ER46829", "ER52237", "ER58038", "ER65216")))

names(TotalLaborIncome.Head) <- mapply(paste, "TotalLaborIncome.Head", c(seq(1968,1997, 1), seq(1999,2015, 2)), sep="_")
```

##Wages and salary head
```{r}
WageSal.Head <- df %>% select(one_of(c("V251", "V699", "V1191", "V1892", "V2493", "V3046", "V3458", "V3858", "V4373", "V5283", "V5782", "V6391",  "V6981", "V7573", "V8265", "V8873", "V10256", "V11397", "V12796", "V13898", "V14913", "V16413", "V17829",  "V19129", "V20429", "V21739", "ER4122", "ER6962", "ER9213", "ER12196", "ER16493", "ER20425", "ER24117",  "ER27913", "ER40903", "ER46811", "ER52219", "ER58020", "ER65200")))

names(WageSal.Head) <- mapply(paste, "WageSal.Head", c(seq(1968,1997, 1), seq(1999,2015, 2)), sep="_")
```

##Wife's money income from work to 1993
```{r}
TotalLaborIncome1.Spouse <- df %>% select(one_of(c("V75", "V516", "V1198", "V1899", "V2500", "V3053", "V3465", "V3865", "V4379", "V5289", "V5788", "V6398", "V6988", "V7580", "V8273", "V8881", "V10263", "V11404", "V12803", "V13905","V14920", "V16420", "V17836", "V19136", "V20436", "V23324")))

names(TotalLaborIncome1.Spouse) <- mapply(paste, "TotalLaborIncome1.Spouse", seq(1968,1993,1), sep="_")
```

##Wife's money income from work from 1993
```{r}
TotalLaborIncome2.Spouse <- df %>% select(one_of(c("V21807", "ER4144", "ER6984", "ER9235", "ER12082", "ER16465", "ER20447", "ER24135", "ER27943", "ER40933", "ER46841", "ER52249", "ER58050", "ER65244")))

names(TotalLaborIncome2.Spouse) <- mapply(paste, "TotalLaborIncome2.Spouse", c(seq(1993,1997,1), seq(1999,2015,2)), sep="_")
```



##Years worked since 18 head
```{r}
YearsWorked.Head <- df %>% select(one_of(c("V3620", "V4141", "V4630", "V5604", "V6153", "V6750", "V7383", "V8035", "V8659", "V9345", "V10992", "V11739", "V13605", "V14652", "V16126", "V17523", "V18854", "V20154", "V21460", "V23316", "ER3985", "ER6855", "ER9101", "ER11897", "ER15979", "ER20040", "ER23476", "ER27444", "ER40616", "ER46594", "ER51955", "ER57711", "ER64871")))

names(YearsWorked.Head) <- mapply(paste, "YearsWorked.Head", c(seq(1974,1997,1), seq(1999, 2015, 2)), sep="_")
```

##Years worked since 18 spouse
```{r}
YearsWorked.Spouse <- df %>% select(one_of(c("V3610", "V4110", "V4989", "V5574", "V6123", "V6720", "V7353", "V8005", "V8629", "V9315", "V10962", "V12102", "V13531", "V14578", "V16052", "V17449", "V18780", "V20080", "V21386", "V23243", "ER3915", "ER6785", "ER9031", "ER11809", "ER15886", "ER19947", "ER23384", "ER27348", "ER40523", "ER46500", "ER51861", "ER57601", "ER64732")))

names(YearsWorked.Spouse) <- mapply(paste, "YearsWorked.Spouse", c(seq(1974,1997,1), seq(1999, 2015, 2)), sep="_")
```


##Employment status head - ever had a job
```{r}
EverJob.Head<- df %>% select(one_of(c("V4552", "V5454", "V5971", "V6556", "V7158", "V7806", "V8467", "V9104", "V10604", "V11751", "V13147", "V14245", "V15318", "V16833", "V18257", "V19557", "V20857", "V22644", "ER2324", "ER5323", "ER7419", "ER10337", "ER13476", "ER17515", "ER21357", "ER25346", "ER36351", "ER42376", "ER47689", "ER53389", "ER60404")))

names(EverJob.Head) <- mapply(paste, "EverJob.Head", c(seq(1976,1997,1), seq(1999, 2015, 2)), sep="_")

```


##Employment status spouse ever had a job
```{r}
EverJob.Spouse <- df %>% select(one_of(c("V4936", "V6628", "V7230", "V7919", "V8574", "V9233", "V10804", "V12114", "V13315", "V14409", "V15620", "V17152", "V18559", "V19859", "V21159", "V22997", "ER2818", "ER5817", "ER7913", "ER10819", "ER13988", "ER18086", "ER21607", "ER25604", "ER36609", "ER42628", "ER47946", "ER53652", "ER60667")))

names(EverJob.Spouse) <- mapply(paste, "EverJob.Spouse", c(1976, seq(1979,1997,1), seq(1999, 2015, 2)), sep="_")
```

##Employment status working now 1? Head
```{r}
EmployedNow1.Head <- df %>% select(one_of(c("V196", "V639", "V1278", "V1983", "V2581", "V3114", "V3528", "V3967", "V4458", "V5373", "V5872", "V6492", "V7095", "V7706", "V8374", "V9005", "V10453", "V11637", "V13046", "V14146", "V15154", "V16655", "V18093", "V19393", "V20693", "V22448", "ER2068", "ER5067", "ER7163")))

names(EmployedNow1.Head) <- mapply(paste, "EmployedNow1.Head", seq(1968, 1996, 1), sep="_")
```

Employment status working now 2  head
```{r}
EmployedNow2.Head <- df %>% select(one_of(c("ER2069", "ER5068", "ER7164", "ER10081", "ER13205", "ER17216", "ER21123", "ER25104", "ER36109", "ER42140", "ER47448", "ER53148", "ER60163")))
names(EmployedNow2.Head) <- mapply(paste, "EmployedNow2.Head", c(seq(1994,1997,1), seq(1999,2015,2)), sep="_")
```

Employment status working now spouse
```{r}
EmployedNow1.Spouse <- df %>% select(one_of(c("V4841", "V6591", "V7193", "V7879", "V8538", "V9188", "V10671", "V12000", "V13225", "V14321", "V15456", "V16974", "V18395", "V19695", "V20995", "V22801", "ER2562", "ER5561", "ER7657")))

names(EmployedNow1.Spouse) <- mapply(paste, "EmployedNow1.Spouse", c(1976, seq(1979,1996,1)), sep="_")
```

Employment status working now spouse
```{r}
EmployedNow2.Spouse <- df %>% select(one_of(c("ER2563", "ER5562", "ER7658", "ER10563", "ER13717", "ER17786", "ER21373", "ER25362", "ER36367", "ER42392", "ER47705", "ER53411", "ER60426")))
names(EmployedNow2.Spouse) <- mapply(paste, "EmployedNow2.Spouse", c(seq(1994,1997,1), seq(1999,2015,2)), sep="_")
```

##Head's annual work hours
```{r}
WorkHrs.Head <- df %>% select(one_of(c("V47", "V465", "V1138", "V1839", "V2439", "V3027", "V3423", "V3823", "V4332", "V5232", "V5731", "V6336", "V6934", "V7530", "V8228", "V8830", "V10037", "V11146", "V12545", "V13745", "V14835", "V16335", "V17744", "V19044", "V20344", "V21634", "ER4096", "ER6936", "ER9187", "ER12174", "ER16471", "ER20399", "ER24080", "ER27886", "ER40876", "ER46767", "ER52175", "ER57976", "ER65156")))
names(WorkHrs.Head) <- mapply(paste, "WorkHrs.Head", c(seq(1968,1997,1), seq(1999,2015, 2)), sep="_") 
```

##Spouse annual work hours
```{r}
WorkHrs.Spouse <- df %>% select(one_of(c("V53", "V475", "V1148", "V1849", "V2449", "V3035", "V3431", "V3831", "V4344", "V5244", "V5743", "V6348", "V6946", "V7540", "V8238", "V8840", "V10131", "V11258", "V12657", "V13809", "V14865", "V16365", "V17774", "V19074", "V20374", "V21670", "ER4107", "ER6947", "ER9198", "ER12185", "ER16482", "ER20410", "ER24091", "ER27897", "ER40887", "ER46788", "ER52196", "ER57997", "ER65177")))
names(WorkHrs.Spouse) <- mapply(paste, "WorkHrs.Spouse", c(seq(1968,1997,1), seq(1999,2015, 2)), sep="_") 
```

##Industry of head - 1970 code
```{r}
Industry1980.Head <- df %>% select(one_of(c("V197_B", "V640_B", "V1279_B", "V1985_A", "V2583_A", "V3116_A", "V3531_A", "V3969_A", "V4460_A", "V5375_A", "V5874_A", "V6498_A", "V7101_A")))
names(Industry1980.Head) <- mapply(paste, "Industry1980.Head", seq(1968,1980,1), sep="_")
```

##Industry of spouse - 1970 code
```{r}
Industry1980.Spouse <- df %>% select(one_of(c("V243_B", "V609_B", "V1367_B", "V2075_A", "V2673_A", "V3184_A", "V3602_A", "V4056_A", "V4606_A", "V5508_A", "V6040_A", "V6597_A", "V7199_A")))
names(Industry1980.Spouse) <- mapply(paste, "Industry1980.Spouse", seq(1968,1980,1), sep="_")
```

##Industry of head - 1970 code
```{r}
Industry2001.Head <- df %>% select(one_of(c("V7713", "V8381", "V9012", "V10461", "V11652", "V13055", "V14155", "V15163", "V16664", "V18102", "V19402", "V20702", "V22457", "ER4018", "ER6858", "ER9109", "ER12086", "ER13216", "ER17227")))

names(Industry2001.Head) <- mapply(paste, "Industry2001.Head", c(seq(1981,1997,1), 1999,2001), sep="_")
```

##Industry of spouse - 1970 code
```{r}
Industry2001.Spouse <- df %>% select(one_of(c("V7886", "V8545", "V9195", "V10679", "V12015", "V13234", "V14330", "V15465", "V16983", "V18404", "V19704", "V21004", "V22810", "ER4049", "ER6889", "ER9140", "ER12117", "ER13728", "ER17797")))

names(Industry2001.Spouse) <- mapply(paste, "Industry2001.Spouse", c(seq(1981,1997,1), 1999,2001), sep="_")
```

##Industry of head - 2000 code
```{r}
Industry2015.Head <- df %>% select(one_of(c("ER21146", "ER25128", "ER36133", "ER42168", "ER47480", "ER53180", "ER60195")))
names(Industry2015.Head) <- mapply(paste, "Industry2015.Head", seq(2003,2015, 2), sep="_")
```

##Industry of spouse -- 2000 code
```{r}
Industry2015.Spouse <- df %>% select(one_of(c("ER21396", "ER25386", "ER36391", "ER42420", "ER47737", "ER53443", "ER60458")))
names(Industry2015.Spouse) <- mapply(paste, "Industry2015.Spouse", seq(2003,2015, 2), sep="_")
```

##Head occupation --1970 code
```{r}
Occupation1980.Head <- df %>% select(one_of(c("V197_A", "V640_A", "V1279_A", "V1984_A", "V2582_A", "V3115_A", "V3530_A", "V3968_A", "V4459_A", "V5374_A", "V5873_A", "V6497_A", "V7100_A")))

names(Occupation1980.Head) <- mapply(paste, "Occupation1980.Head", seq(1968,1980,1), sep="_")
```

##Spouse occupation -- 1970 code
```{r}
Occupation1980.Spouse <- df %>% select(one_of(c("V243_A", "V609_A", "V1367_A", "V2074_A", "V2672_A", "V3183_A", "V3601_A", "V4055_A", "V4605_A", "V5507_A", "V6039_A", "V6596_A", "V7198_A")))
names(Occupation1980.Spouse) <- mapply(paste, "Occupation1980.Spouse", seq(1968,1980,1), sep="_")
```

##Head occupation 1970 code
```{r}
Occupation2001.Head <- df %>% select(one_of(c("V3529", "V7712", "V8380", "V9011", "V10460", "V11651", "V13054", "V14154", "V15162", "V16663", "V18101", "V19401", "V20701", "V22456", "ER4017", "ER6857", "ER9108", "ER12085", "ER13215", "ER17226")))

names(Occupation2001.Head) <- mapply(paste, "Occupation2001.Head", c(1974, seq(1981,1997,1), 1999, 2001), sep="_")
```

##Spouse occupation 1970 code
```{r}
Occupation2001.Spouse <- df %>% select(one_of(c("V7885", "V8544", "V9194", "V10678", "V12014", "V13233", "V14329", "V15464", "V16982", "V18403", "V19703", "V21003", "V22809", "ER4048", "ER6888", "ER9139", "ER12116", "ER13727", "ER17796")))

names(Occupation2001.Spouse) <-  mapply(paste, "Occupation2001.Spouse",c(seq(1981,1997,1), 1999, 2001), sep="_")
```

##Head self-employed?
```{r}
SelfEmp2001.Head <- df %>% select(one_of(c("V198", "V641", "V1280", "V1986", "V2584", "V3117", "V3532", "V3970", "V4461", "V5376", "V5875", "V6493", "V7096", "V7707", "V8375", "V9006", "V10456", "V11640", "V13049", "V14149", "V15157", "V16658", "V18096", "V19396", "V20696", "V22451", "ER2074", "ER5073", "ER7169", "ER10086", "ER13210", "ER17221")))

names(SelfEmp2001.Head) <- mapply(paste, "SelEmp2001.Head", c(seq(1968,1997,1), 1999, 2001), sep="_")
```

##Spouse self-employed?
```{r}
SelfEmp2001.Spouse <- df %>% select(one_of(c("V4844", "V6592", "V7194", "V7880", "V8539", "V9189", "V10674", "V12003", "V13228", "V14324", "V15459", "V16977", "V18398", "V19698", "V20998", "V22804", "ER2568", "ER5567", "ER7663", "ER10568", "ER13722", "ER17791")))

names(SelfEmp2001.Spouse) <- mapply(paste, "SelfEmp2001.Spouse", c(1974, seq(1979,1997,1), 1999, 2001), sep="_")
```

##Head occupation -- 2000 code
```{r}
Occupation2015.Head <- df %>% select(one_of(c("ER21145", "ER25127", "ER36132", "ER42167", "ER47479", "ER53179", "ER60194")))
names(Occupation2015.Head) <- mapply(paste, "Occupation2015.Head", seq(2003,2015,2), sep="_")
```

##Head self employed
```{r}
SelfEmp2015.Head <- df %>% select(one_of(c("ER21147", "ER25129", "ER36134", "ER42169", "ER47482", "ER53182", "ER60197")))
names(SelfEmp2015.Head) <- mapply(paste, "SelfEmp2015.Head", seq(2003,2015,2), sep="_")
```

##Spouse occupation --- 2000 code
```{r}
Occupation2015.Spouse <- df %>% select(one_of(c("ER21395", "ER25385", "ER36390", "ER42419", "ER47736", "ER53442", "ER60457")))
names(Occupation2015.Spouse) <- mapply(paste, "Occupation2015.Spouse", seq(2003,2015,2), sep="_")
```

##Spouse self employed
```{r}
SelfEmp2015.Spouse <- df %>% select(one_of(c("ER21397", "ER25387", "ER36392", "ER42421", "ER47739", "ER53445", "ER60460")))
names(SelfEmp2015.Spouse) <- mapply(paste, "SelfEmp2015.Spouse", seq(2003,2015,2), sep="_")
```


##Head belong to union
```{r}
UnionMember1981.Head <- df %>% select(one_of(c("V294", "V766", "V1434", "V2145", "V2787", "V3636", "V4087", "V4624", "V5559", "V6101", "V6707", "V7340", "V7971")))

names(UnionMember1981.Head) <- mapply(paste, "UnionMember1981.Head", c(seq(1968,1972,1), seq(1974,1981,1)), sep="_")
```

##Spouse belong to union
```{r}
UnionMember1981.Spouse <- df %>% select(one_of(c("V4929", "V6709", "V7342", "V7973")))

names(UnionMember1981.Spouse) <- mapply(paste,"UnionMember1981.Spouse", c(1976, 1979:1981), sep="_")
```

##Head covered by union
```{r}
UnionCovered.Head <- df %>% select(one_of(c("V4478", "V5382", "V5877", "V6495", "V7098", "V7709", "V8377", "V9008", "V10458", "V11649", "V13052", "V14152", "V15160", "V16661", "V18099", "V19399", "V20699", "V22454", "ER2079", "ER5078", "ER7174", "ER10089", "ER13213", "ER17224", "ER21150", "ER25138", "ER36143", "ER42178", "ER47491", "ER53191", "ER60206")))

names(UnionCovered.Head) <- mapply(paste, "UnionCovered.Head", c(1976:1997, seq(1999,2015,2)), sep="_")
```

##Spouse covered by union
```{r}
UnionCovered.Spouse <- df %>% select(one_of(c("V4861", "V6594", "V7196", "V7882", "V8541", "V9191", "V10676", "V12012", "V13231", "V14327", "V15462", "V16980", "V18401", "V19701", "V21001", "V22807", "ER2573", "ER5572", "ER7668", "ER10571", "ER13725", "ER17794", "ER21400", "ER25396", "ER36401", "ER42430", "ER47748", "ER53454", "ER60469")))

names(UnionCovered.Spouse) <- mapply(paste, "UnionCovered.Spouse", c(1976, 1979:1997, seq(1999,2015,2)), sep="_")
```

##AGE
```{r}
Age.Head <- df %>% select(one_of(c("ER30004", "ER30023", "ER30046", "ER30070", "ER30094", "ER30120", "ER30141", "ER30163", "ER30191", "ER30220", "ER30249", "ER30286", "ER30316", "ER30346", "ER30376", "ER30402", "ER30432", "ER30466", "ER30501", "ER30538", "ER30573", "ER30609", "ER30645", "ER30692", "ER30736", "ER30809", "ER33104", "ER33204", "ER33304", "ER33404", "ER33504", "ER33604", "ER33704", "ER33804", "ER33904", "ER34004", "ER34104", "ER34204", "ER34305")))

names(Age.Head) <- mapply(paste, "Age.Head", c(1968:1997, seq(1999,2015,2)), sep="_")
```

##SEX
```{r}
df$Sex <- df$ER32000

```

##Grades completed
```{r}
GradesCompl <- df %>% select(one_of(c("ER30010", "ER30052", "ER30076", "ER30100", "ER30126", "ER30147", "ER30169", "ER30197", "ER30226", "ER30255", "ER30296", "ER30326", "ER30356", "ER30384", "ER30413", "ER30443", "ER30478", "ER30513", "ER30549", "ER30584", "ER30620", "ER30657", "ER30703", "ER30748", "ER30820", "ER33115", "ER33215", "ER33315", "ER33415", "ER33516", "ER33616", "ER33716", "ER33817", "ER33917", "ER34020", "ER34119", "ER34230", "ER34349")))

names(GradesCompl) <- mapply(paste, "GradesCompl", c(1968, 1970:1997, seq(1999,2015,2)), sep="_")
```

##Health insurance covered now
```{r}
HealthInsNow <- df %>% select(one_of(c("ER34128", "ER34235", "ER34385")))
names(HealthInsNow) <- mapply(paste, "HealthInsNow", c(2011,2013,2015), sep="_")
```

##Sample weight longitudinal core and immigrant
```{r}
SampWeight2015 <- df %>% select(one_of(c("ER33430", "ER33546", "ER33637", "ER33740", "ER33848", "ER33950", "ER34045", "ER34154", "ER34268", "ER34413")))

names(SampWeight2015) <- mapply(paste, "SampWeight2015", seq(1997, 2015, 2), sep="_")

```

##Sample weight longitudinal core
```{r}
SampWeight1996<- df %>% select(one_of(c("ER30019", "ER30042", "ER30066", "ER30090", "ER30116", "ER30137", "ER30159", "ER30187", "ER30216", "ER30245", "ER30282", "ER30312", "ER30342", "ER30372", "ER30398", "ER30428", "ER30462", "ER30497", "ER30534", "ER30569", "ER30605", "ER30641", "ER30686", "ER30730", "ER30803")))

names(SampWeight1996) <- mapply(paste, "SampWeight1996", c(1968:1992), sep="_")
```

##Sample weight longitudinal core 1993 revised
```{r}
SampWeight9396Rev <- df %>% select(one_of(c("ER30864", "ER33119", "ER33275", "ER33318")))
names(SampWeight9396Rev) <- mapply(paste, "SampWeight9396Rev", c(1993:1996), sep="_")
```

##ID INTERVIEW NUMBER 
```{r}
InterviewNum <- df %>% select(one_of(c("ER30001", "ER30020", "ER30043", "ER30067", "ER30091", "ER30117", "ER30138", "ER30160", "ER30188", "ER30217", "ER30246", "ER30283", "ER30313", "ER30343", "ER30373", "ER30399", "ER30429", "ER30463", "ER30498", "ER30535", "ER30570", "ER30606", "ER30642", "ER30689", "ER30733", "ER30806", "ER33101", "ER33201", "ER33301", "ER33401", "ER33501", "ER33601", "ER33701", "ER33801", "ER33901", "ER34001", "ER34101", "ER34201", "ER34301")))

names(InterviewNum) <- mapply(paste, "InterviewNum", c(1968:1997, seq(1999,2015, 2)), sep="_")
```

##PERSON NUMBER
```{r}
df$PersonNum <- df$ER30002
```


##RELATION TO HEAD
```{r}
RelationToHead <- df %>% select(one_of(c("ER30003", "ER30022", "ER30045", "ER30069", "ER30093", "ER30119", "ER30140", "ER30162", "ER30190", "ER30219", "ER30248", "ER30285", "ER30315", "ER30345", "ER30375", "ER30401", "ER30431", "ER30465", "ER30500", "ER30537", "ER30572", "ER30608", "ER30644", "ER30691", "ER30735", "ER30808", "ER33103", "ER33203", "ER33303", "ER33403", "ER33503", "ER33603", "ER33703", "ER33803", "ER33903", "ER34003", "ER34103", "ER34203", "ER34303")))

names(RelationToHead) <- mapply(paste, "RelationToHead", c(1968:1997, seq(1999,2015, 2)), sep="_")

```


##Sequence number
```{r}
SeqNum <- df %>% select(one_of(c("ER30021", "ER30044", "ER30068", "ER30092", "ER30118", "ER30139", "ER30161", "ER30189", "ER30218", "ER30247", "ER30284", "ER30314", "ER30344", "ER30374", "ER30400", "ER30430", "ER30464", "ER30499", "ER30536", "ER30571", "ER30607", "ER30643", "ER30690", "ER30734", "ER30807", "ER33102", "ER33202", "ER33302", "ER33402", "ER33502", "ER33602", "ER33702", "ER33802", "ER33902", "ER34002", "ER34102", "ER34202", "ER34302")))

names(SeqNum) <- mapply(paste, "SeqNum", c(1969:1997, seq(1999,2015, 2)), sep="_")
```


##Sampling error cluster
```{r}
df$SampErrClust <- df$ER31997

```

##Sampling error stratum
```{r}
df$SampErrStrat <- df$ER31996

```


#Combine everything

```{r}

colgroups <- ls()

AnalysisData_Wide <- cbind(df[,c("ID", "SampErrClust", "SampErrStrat", "Sex")], bind_cols(mget(colgroups[!(colgroups %in% c("df", "RAW"))])))

save(AnalysisData_Wide, file="/Users/SJP1/Dropbox/Gender economics/Exploitation IPW-MSM/PSID-Exploitation/AnalysisData_Wide.Rdata")

names(AnalysisData_Wide)

```

#Wide to long
```{r}


AnalysisData <- AnalysisData_Wide %>% 
                      gather(key=var, value=val, -ID, -SampErrClust, -SampErrStrat, -Sex) %>%
                      separate(var, c("Variable", "Year"), "_")


AnalysisData <- AnalysisData %>% spread(Variable, val)

save(AnalysisData, file="/Users/SJP1/Dropbox/Gender economics/Exploitation IPW-MSM/PSID-Exploitation/AnalysisData.Rdata")

```

!!!!!!!!!!!!!!!!
#Make heads and spouses unique subjects -- don't run because only looking at Heads for K6
```{r}

load("/Users/SJP1/Dropbox/Gender economics/Exploitation IPW-MSM/PSID-Exploitation/AnalysisData.Rdata")

AnalysisData1 <- AnalysisData %>% 
                    mutate(RelationToHead = ifelse(Year %in% c(1968:1982), RelationToHead+10, RelationToHead),
Age = ifelse(RelationToHead==10, Age.Head, ifelse(RelationToHead %in% c(20,22,90), Age.Spouse, NA)),
AgeDrEmotProb = ifelse(RelationToHead==10, AgeDrEmotProb.Head, ifelse(RelationToHead %in% c(20,22,90), AgeDrEmotProb.Spouse, NA)),
AgeDrLearnDisord = ifelse(RelationToHead==10, AgeDrLearnDisord.Head, ifelse(RelationToHead %in% c(20,22,90), AgeDrLearnDisord.Spouse, NA)),
AlcFreq = ifelse(RelationToHead==10, AlcFreq.Head, ifelse(RelationToHead %in% c(20,22,90), AlcFreq.Spouse, NA)),
ConditionPsych = ifelse(RelationToHead==10, ConditionPsych.Head, ifelse(RelationToHead %in% c(20,22,90), ConditionPsych.Spouse, NA)),
Depressed17 = ifelse(RelationToHead==10, Depressed17.Head, ifelse(RelationToHead %in% c(20,22,90), Depressed17.Spouse, NA)),
DrEmotProb = ifelse(RelationToHead==10, DrEmotProb.Head, ifelse(RelationToHead %in% c(20,22,90), DrEmotProb.Spouse, NA)),
Drink5 = ifelse(RelationToHead==10, Drink5.Head, ifelse(RelationToHead %in% c(20,22,90), Drink5.Spouse, NA)),
DrinksPerDay = ifelse(RelationToHead==10, DrinksPerDay.Head, ifelse(RelationToHead %in% c(20,22,90), DrinksPerDay.Spouse, NA)),
DrLearnDisord = ifelse(RelationToHead==10, DrLearnDisord.Head, ifelse(RelationToHead %in% c(20,22,90), DrLearnDisord.Spouse, NA)),
DrMemLoss = ifelse(RelationToHead==10, DrMemLoss.Head, ifelse(RelationToHead %in% c(20,22,90), DrMemLoss.Spouse, NA)),
DrugProb17 = ifelse(RelationToHead==10, DrugProb17.Head, ifelse(RelationToHead %in% c(20,22,90), DrugProb17.Spouse, NA)),
EmotProb = ifelse(RelationToHead==10, EmotProb.Head, ifelse(RelationToHead %in% c(20,22,90), EmotProb.Spouse, NA)),
EmployedNow = ifelse(RelationToHead==10 & Year <=1996 , EmployedNow1.Head, ifelse(RelationToHead %in% c(20,22,90) & Year <=1996, EmployedNow1.Spouse, ifelse(RelationToHead==10 & Year > 1996, EmployedNow2.Head, ifelse(RelationToHead %in% c(20,22,90) & Year > 1996, EmployedNow2.Spouse, NA)))),
EverJob = ifelse(RelationToHead==10, EverJob.Head, ifelse(RelationToHead %in% c(20,22,90), EverJob.Spouse, NA)),
EverSmoked = ifelse(RelationToHead==10, EverSmoked.Head, ifelse(RelationToHead %in% c(20,22,90), EverSmoked.Spouse, NA)),
GenHealth = ifelse(RelationToHead==10, GenHealth.Head, ifelse(RelationToHead %in% c(20,22,90), GenHealth.Spouse, NA)),
Industry = ifelse(RelationToHead==10 & Year<=1980, Industry1980.Head, ifelse(RelationToHead==10 & Year>1980 & Year<=2001, Industry2001.Head, ifelse(RelationToHead==10 & Year>2001, Industry2015.Head, ifelse(RelationToHead %in% c(20,22,90) & Year<=1980, Industry1980.Spouse, ifelse(RelationToHead %in% c(20,22,90) & Year>1980 & Year<=2001, Industry2001.Spouse, ifelse(RelationToHead %in% c(20,22,90) & Year>2001, Industry2015.Spouse, NA) ))))),
InterestIncome = ifelse(RelationToHead==10, InterestIncome.Head, ifelse(RelationToHead %in% c(20,22,90), InterestIncome.Spouse, NA)),
KidHealth = ifelse(RelationToHead==10, KidHealth.Head, ifelse(RelationToHead %in% c(20,22,90), KidHealth.Spouse, NA)),
MedforPsych = ifelse(RelationToHead==10, MedforPsych.Head, ifelse(RelationToHead %in% c(20,22,90), MedforPsych.Spouse, NA)),
MedLearnDisord = ifelse(RelationToHead==10, MedLearnDisord.Head, ifelse(RelationToHead %in% c(20,22,90), MedLearnDisord.Spouse, NA)),
Occupation = ifelse(RelationToHead==10 & Year<=1980, Occupation1980.Head, ifelse(RelationToHead==10 & Year>1980 & Year<=2001, Occupation2001.Head, ifelse(RelationToHead==10 & Year>2001, Occupation2015.Head, ifelse(RelationToHead %in% c(20,22,90) & Year<=1980, Occupation1980.Spouse, ifelse(RelationToHead %in% c(20,22,90) & Year>1980 & Year<=2001, Occupation2001.Spouse, ifelse(RelationToHead %in% c(20,22,90) & Year>2001, Occupation2015.Spouse, NA) ))))),
Race = ifelse(RelationToHead==10, Race.Head, ifelse(RelationToHead %in% c(20,22,90), Race.Spouse, NA)),
SelfEmp = ifelse(RelationToHead==10 & Year <=2001, SelEmp2001.Head, ifelse(RelationToHead==10 & Year >2001, SelfEmp2015.Head, ifelse(RelationToHead %in% c(20,22,90) & Year<=2001, SelfEmp2001.Spouse, ifelse(RelationToHead %in% c(20,22,90) & Year>2001, SelfEmp2015.Spouse, NA)))),
TotalLaborIncome = ifelse(RelationToHead==10, TotalLaborIncome.Head, ifelse(RelationToHead %in% c(20,22,90) & Year<1993, 
                                                                              TotalLaborIncome1.Spouse, ifelse(RelationToHead %in% c(20,22,90) & Year>=1993, 
                                                                              TotalLaborIncome2.Spouse, NA))),
UnionCovered = ifelse(RelationToHead==10, UnionCovered.Head, ifelse(RelationToHead %in% c(20,22,90), UnionCovered.Spouse, NA)),
UnionMember1981 = ifelse(RelationToHead==10, UnionMember1981.Head, ifelse(RelationToHead %in% c(20,22,90), UnionMember1981.Spouse, NA)),
WorkHrs = ifelse(RelationToHead==10, WorkHrs.Head, ifelse(RelationToHead %in% c(20,22,90), WorkHrs.Spouse, NA)),
YearsWorked = ifelse(RelationToHead==10, YearsWorked.Head, ifelse(RelationToHead %in% c(20,22,90), YearsWorked.Spouse, NA))
  )
                                  

AnalysisDataSERabstract <- AnalysisData1 %>% select(-contains("."), K6.Head, WageSal.Head, -InsuranceHeadFam)


save(AnalysisDataSERabstract, file= "/Users/SJP1/Dropbox/Gender economics/Exploitation IPW-MSM/PSID-Exploitation/SERdata.Rdata")


```
!!!!!!!!!!!!!!!!
















